#!/bin/bash
if [ "$1" == "" ] || [ "$2" == "" ]; then
echo "Usage: `basename $0` {URL|IP} {TCP PORT} [DUBUG=false|true]"
else
INDEX=0
RESOLVED=`ping -q -c 1 -t 1 $1 | grep PING | awk {'print $3'} | sed "s/[()]//g"`
echo "NMAP PING $1 ($RESOLVED)"
while [ 1==1 ]; do
INDEX=$((INDEX+1))
if [ "$3" == "true" ]; then
RESULT=`nmap -P0 -T5 -p$2 $RESOLVED --unprivileged`
else
RESULT=`nmap -P0 -T5 -p$2 $RESOLVED --unprivileged | grep "Host is up" | awk {'print $4'} | sed 's/[^0-9\.]//g'`
fi
echo "Resp: $RESOLVED:$2/tcp Seq=$INDEX at $RESULT ms"
sleep 1
done
fi
